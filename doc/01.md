# 01 | TDD演示（1）任务分解法与整体工作流程

## TDD 模板

1. API 构思与组件划分
   首先我们需要考虑，**别人将以何种方式使用这段代码**，也就是这段代码的整体对外接口部分。
   我们可以通过写测试的方式，来感受 API 的友好程度
2. 在确定了 API 的形式之后，我们需要大致构思如何实现这个功能
3. 功能分解与任务列表 ⭐️⭐️⭐️⭐️⭐️（TDD 核心之一）
   在 API 与实现方式有了方向之后，我们就可以根据需求的描述对功能进行分解了。
   这里可以先不求全面，有个大致的范围即可
4. 红 / 绿循环
   那么先让我们选择最简单的任务，并通过红绿循环实现它

## 功能分析

### 简介

解析空格分割的字符串

### 示例

```cmd
-l -p 8080 -d /usr/logs -g this is a list -d 1 2 -3 5
```

### 功能

- 减号后的字符代表一个功能符号
- l
  - 功能：日志，没有相关的值
  - 类型：布尔
  - 描述：存在=true；不存在=false
- p
  - 功能：端口
  - 类型：整数
  - 描述：有一个整数值
- d
  - 功能：目录
  - 类型：字符串
  - 描述有一个字符串
- g
  - 功能：一个字符串列表
  - 类型：字符串
- d
  - 功能：表示一个整数列表
  - 类型：整数组成的字符串
- 如果参数中没有指定某个标志，那么解析器应该指定一个默认值
  - 布尔：false
  - 整数：0
  - 列表：[]
- 如果给出的参数与模式不匹配，给出友好提示
  - 简要错误信息
  - 告知错误原因

## 实现思路

### 三种实现方式

1. -l -p 8080 -d /usr/logs 一次解析整个字符串解析（难度大）
2. [-l], [-p, 8080], [-d, /usr/logs] 按功能划分，处理特定数组（简单）💡 课程中选取了最简单的方案实现
3. {-l:[], -p:[8080], -d:[/usr/logs]} 按功能划分，从Map中取出相应的值（比数组复杂）

### 方式 2 的实现

#### 单个功能

- 布尔类型：-l
- 单整数类型：-p 8080
- 单个连续字符串类型：-d /usr/logs

#### 组合功能

-l -p 8080 -d /usr/logs

#### 异常情况

- 布尔类型：输入 -l a; -l 3
- 单整数类型：输入 -p a; -p 3.14
- 单个连续字符串类型：输入 -d a b c; -d /usr/logs /usr/logs/a.log

## 感悟

- 站在使用者的角度看待自己的代码



